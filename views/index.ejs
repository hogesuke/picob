<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <script type="text/javascript" src="/javascripts/jquery.min.js"></script>
    <script type="text/javascript" src="/javascripts/knockout-3.0.0.js"></script>
    <script type="text/javascript" src="/javascripts/knockout.mapping-latest.js"></script>
    <script type="text/javascript" src="/javascripts/jquery.simplemodal.js"></script>
    <script type="text/javascript" src="/javascripts/matchMedia.js"></script>
    <script type="text/javascript" src="/javascripts/picob.js"></script>
    <link rel='stylesheet' href='/stylesheets/cssreset-min.css' />
    <link rel='stylesheet' href='/stylesheets/picob.css' />
  </head>
  <body>
    <div id="container">
      <div id="controler">
        <div id="month-controler">
          <div id="prev-month" class="web-icon-fontello">4</div>
          <div id="list-month">
            <ul>
              <% for(var i = 0; i < monthArray.length; i++) { %>
                <li class="<%= monthArray[i].state %>"
                  year="<%= monthArray[i].year %>" month="<%= monthArray[i].month %>">
                  <%= monthArray[i].year + "/" + monthArray[i].month %>
                </li>
              <% } %>
            </ul>
          </div>
          <div id="next-month" class="web-icon-fontello">5</div>
        </div>
      </div>
      <div id="day">
        <div class="holiday">Sun</div>
        <div>Mon</div>
        <div>Tue</div>
        <div>Wed</div>
        <div>Thu</div>
        <div>Fri</div>
        <div class="holiday">Sat</div>
      </div>
      <div id="pieces">
        <% var pieceNo = 0; %>
        <div class="week" week="1">
        <% /* 6週間分 */ %>
        <% for(var i = 0; i < 6; i++) { %>
          <div class="week" week="<%= i + 1 %>">
            <% /* 1週間(7日) */ %>
            <% for(var j = 0; j < 7; j++) { %>
              <!-- ko if: pieces()[<%= pieceNo %>] -->
              <div data-bind="template: {name: 'piece-template', data: {piece: pieces()[<%= pieceNo %>]}},
                css: pieces()[<%= pieceNo %>].getPieceCss()">
              </div>
              <!-- /ko -->
              <% pieceNo++; %>
            <% } %>
          </div>
        <% } %>

        <script type="text/html" id="piece-template">
          <!-- ko if: !piece.isDummy() -->
          <div data-bind="text: piece.date, attr: {'year': piece.year, 'month': piece.month, 'day': piece.day}" class="date"></div>
          <div data-bind="text: piece.feeling" class="feeling web-icon-fontello"></div>
          <div data-bind="style: {display: piece.isCompleted() ? 'none' : 'block'}" class="empty-feeling web-icon-fontello">6</div>
          <div class="feeling-text">
            <!-- ko if: piece.existFeelingText() -->
              <span data-bind="text: piece.feeling_text.text"></span>
            <!-- /ko -->
          </div>
          <form class="edit-form" style="display: none;">
            <input class="input-feeling" data-bind="value: piece.feeling" />
          </form>
          <!-- /ko -->
        </script>

        <div id="feeling-text-window" class=".inactive">
          <div class="feeling-selector">
            <div class="feeling-choices feeling-good web-icon-fontello">1</div>
            <div class="feeling-choices feeling-normal web-icon-fontello">3</div>
            <div class="feeling-choices feeling-bad web-icon-fontello">2</div>
          </div>
          <% for (var groupName in feelings) { %>
            <div class="feeling-group-title"><%= groupName %></div>
            <div id="feeling-text-container">
              <ul>
                <% for (var i in feelings[groupName]) { %>
                  <% var feeling = feelings[groupName]; %>
                  <li>
                    <a class="feeling-text-choices" href="javascript:void(0)" feeling-text-id='<%= feeling[i]._id %>'>
                      <%= feeling[i].text %>
                    </a>
                  </li>
                <% } %>
              </ul>
            </div>
          <% } %>
          <input type="button" id="post-button" value="POST">
        </div>

      </div>
    </div>
  </body>
</html>
